<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Include noUiSlider CSS -->
    <link rel="stylesheet" href="libs/css/nouislider.min.css" />
    <link rel="icon" href="./favicon.ico" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Random Groove Trainer</title>
    <link rel="stylesheet" href="./css/styles.css" />
  </head>
  <body>
    <h1>Random Groove Trainer</h1>
    <p class="small">
      Randomize BPM (multiples of 5) + groove name and practice landing grooves
      instantly. Built-in metronome uses lightweight bundled javascript for
      accuracy.
    </p>
    <div id="tooltipTrigger" title="Help / Hotkeys">‚ùî</div>
    <div id="tooltipDialog">
      <div class="tooltip-content">
        <h2>üéµ Random Groove Trainer</h2>
        <p>
          This app helps you practice groove transitions by randomly selecting a
          BPM and groove name. You set a BPM range, enter groove names, and
          choose session settings. The built-in metronome guides you through
          each cycle.
        </p>

        <p><strong>How to use:</strong></p>
        <ul>
          <li>Set your desired BPM range</li>
          <li>Enter groove names (one per line)</li>
          <li>Choose session duration or cycle count</li>
          <li>
            Click <strong>Start</strong> or press <strong>Space</strong> to
            begin
          </li>
        </ul>

        <p><strong>Hotkeys:</strong></p>
        <ul>
          <li>H = Show this help</li>
          <li>‚éµ Space = ‚ñ∂Ô∏è Start / ‚èπÔ∏è Stop</li>
          <li>P = ‚è∏Ô∏è Pause / ‚ñ∂Ô∏è Resume</li>
          <li>N = ‚è≠Ô∏è Next Groove</li>
          <li>‚¨ÜÔ∏è / ‚¨áÔ∏è = Adjust BPM (¬±5)</li>
          <li>‚Üê / ‚Üí = Switch Min/Max</li>
        </ul>
      </div>
    </div>
    <button
      id="checkUpdatesBtn"
      class="update-button"
      title="Check for updates"
    >
      ‚ü≥
    </button>

    <!-- TABS -->
    <div class="mode-tabs" role="tablist" aria-label="Mode selector">
      <button
        id="tab-groove"
        class="tab active"
        role="tab"
        aria-selected="true"
      >
        Groove Randomizer
      </button>
      <button id="tab-metronome" class="tab" role="tab" aria-selected="false">
        Metronome
      </button>
    </div>

    <!-- PANELS -->
    <!-- Groove panel -->
    <div id="panel-groove" class="panel">
      <!-- BEGIN existing Groove UI -->
      <label>BPM range (min / max)</label>
      <div class="row">
        <div class="col">
          <input
            id="bpmMin"
            type="number"
            inputmode="numeric"
            min="5"
            max="300"
            value="30"
            step="5"
          />
        </div>
        <div class="col">
          <input
            id="bpmMax"
            type="number"
            inputmode="numeric"
            min="5"
            max="300"
            value="60"
            step="5"
          />
        </div>
      </div>
      <!-- Groove Metronome BPM Range Slider -->
      <div id="groove-slider-container">
        <div id="groove-slider"></div>
        <!-- This is where the noUiSlider will go -->
        <div id="groove-ticks-container" class="groove-ticks-container"></div>
        <!-- Numbers Below the Slider -->
        <div id="slider-numbers">
          <!-- Clickable numbers will be inserted dynamically here -->
        </div>
      </div>

      <label>Groove names (one per line)</label>
      <textarea
        id="grooves"
        rows="10"
        placeholder="Rock 
Funk
Ÿàÿßÿ≠ÿØÿ© ŸàŸÜÿµ
ŸÖŸÇÿ≥ŸàŸÖ
Ÿàÿ≠ÿØÿ© ŸÉÿ®Ÿäÿ±ÿ©
ŸÖŸÑŸÅŸàŸÅ"
      >
Rock
Funk
Ÿàÿßÿ≠ÿØÿ© ŸàŸÜÿµ
ŸÖŸÇÿ≥ŸàŸÖ
Ÿàÿ≠ÿØÿ© ŸÉÿ®Ÿäÿ±ÿ©
ŸÖŸÑŸÅŸàŸÅ</textarea
      >

      <div class="row beats-and-sound-row">
        <div class="beats-section">
          <label for="grooveBeatsPerBar">Beats per bar</label>
          <input
            type="number"
            id="grooveBeatsPerBar"
            min="1"
            max="12"
            value="4"
          />
        </div>

        <div class="sound-section">
          <label for="soundProfileGroove">Sound profile</label>
          <select id="soundProfileGroove"></select>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <label>Time per cycle</label>
          <div class="row" style="gap: 6px">
            <input
              id="cycleDuration"
              type="number"
              inputmode="numeric"
              min="1"
              value="60"
              step="1"
            />
            <select id="cycleUnit">
              <option value="seconds" selected>Seconds</option>
              <option value="minutes">Minutes</option>
            </select>
          </div>
        </div>
        <div class="col">
          <label>Session limit (choose one)</label>
          <select id="sessionMode">
            <option value="infinite">Run until Stop</option>
            <option value="cycles">Total cycles (set below)</option>
            <option value="time">Total session time</option>
          </select>
        </div>
      </div>

      <div class="row" style="margin-top: 8px">
        <div class="col">
          <label id="cyclesLabel">Total cycles</label>
          <input
            id="totalCycles"
            type="number"
            inputmode="numeric"
            min="1"
            value="5"
            step="1"
          />
        </div>
        <div class="col">
          <label id="totalTimeLabel">Total session time</label>
          <div class="row" style="gap: 6px">
            <input
              id="totalTime"
              type="number"
              inputmode="numeric"
              min="1"
              value="300"
              step="1"
            />
            <select id="totalTimeUnit">
              <option value="seconds" selected>Seconds</option>
              <option value="minutes">Minutes</option>
              <option value="hours">Hours</option>
            </select>
          </div>
        </div>
      </div>

      <div class="controls">
        <button id="startBtn">Start</button>
        <button id="pauseBtn" disabled>Pause</button>
        <button id="nextBtn" disabled>Next</button>
        <label class="toggle" style="margin-left: 12px">
          <input id="tempoSyncedToggle" type="checkbox" />
          <span id="tempoSyncedLabel">Tempo-synced Count-in</span>
        </label>
      </div>

      <div class="status" aria-live="polite">
        <div class="big" id="displayBpm">BPM: ‚Äî</div>
        <div class="big" id="displayGroove">Groove: ‚Äî</div>
        <div style="margin-top: 8px">
          Cycle remaining time: <span id="countdown">‚Äî</span>
        </div>

        <div style="margin-top: 6px">
          Cycles done: <span id="cyclesDone">0</span>
        </div>

        <div style="margin-top: 6px">
          Session remaining time: <span id="sessionCountdown">‚Äî</span>
        </div>

        <div style="margin-top: 8px">
          <span id="finishingBadge" class="finishing-badge"
            >Finishing bar‚Ä¶</span
          >
        </div>
        <div id="metronomeVisuals">
          <div id="countdownBadge" class="countdown-badge"></div>
          <div id="beat-indicator-container"></div>
        </div>
      </div>
      <!-- END existing Groove UI -->
    </div>

    <!-- Simple Metronome panel (initially hidden) -->
    <div id="panel-metronome" class="panel hidden">
      <label>Metronome BPM</label>
      <input
        id="simpleBpm"
        type="number"
        inputmode="numeric"
        min="30"
        max="300"
        value="120"
        step="5"
      />
      <!-- Simple Metronome Slider -->
      <div id="simple-slider-container" class="groove-slider-container">
        <div id="simpleMetronomeSlider"></div>
        <div id="simple-ticks-container" class="groove-ticks-container"></div>
        <div id="simple-slider-numbers"></div>
      </div>

      <div class="row beats-and-sound-row">
        <div class="beats-section">
          <label for="simpleBeatsPerBar">Beats per bar</label>
          <input
            type="number"
            id="simpleBeatsPerBar"
            min="1"
            max="12"
            value="4"
          />
        </div>

        <div class="sound-section">
          <label for="soundProfileSimple">Sound profile</label>
          <select id="soundProfileSimple"></select>
        </div>
      </div>

      <div class="controls">
        <button id="simpleStartBtn">Start</button>
        <button id="simplePauseBtn" disabled>Pause</button>
        <button id="tapTempoBtn" title="Tap 4‚Äì6 times to set tempo">üñêÔ∏è</button>
      </div>

      <div class="status">
        <div class="big" id="simpleDisplayBpm">BPM: ‚Äî</div>
        <div id="metronomeVisualsSimple" style="margin-top: 12px">
          <div id="countdownBadgeSimple" class="countdown-badge"></div>
          <div id="beat-indicator-container-simple"></div>
        </div>
      </div>
    </div>

    <footer id="VersionNumber"></footer>
    <!-- JS -->
    <script type="module" src="./js/main.js"></script>
    <!-- Include noUiSlider JS -->
    <script src="libs/js/nouislider.min.js"></script>
  </body>
  <div id="uiNotice" class="ui-notice hidden"></div>
</html>
