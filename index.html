<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Random Groove Trainer</title>
    <link rel="stylesheet" href="./css/styles.css" />
  </head>
  <body>
    <h1>Random Groove Trainer</h1>
    <p class="small">
      Randomize BPM (multiples of 5) + groove name and practice landing grooves
      instantly. Built-in metronome uses lightweight bundled javascript for
      accuracy.
    </p>

    <label>BPM range (min / max)</label>
    <div class="row">
      <div class="col">
        <input
          id="bpmMin"
          type="number"
          inputmode="numeric"
          min="5"
          max="500"
          value="30"
          step="5"
        />
      </div>
      <div class="col">
        <input
          id="bpmMax"
          type="number"
          inputmode="numeric"
          min="5"
          max="500"
          value="60"
          step="5"
        />
      </div>
    </div>

    <label>Groove names (one per line)</label>
    <textarea
      id="grooves"
      rows="10"
      placeholder="e.g. Rock \n Funk \n واحدة ونص \n مقسوم \n وحدة كبيرة \n ملفوف"
    >
Rock
Funk
واحدة ونص
مقسوم
وحدة كبيرة
ملفوف
  </textarea
    >

    <!-- NEW: Beats per bar input -->
    <label>Beats per bar</label>
    <input
      id="beatsPerBar"
      type="number"
      inputmode="numeric"
      min="1"
      max="12"
      value="4"
    />

    <div class="row">
      <div class="col">
        <label>Time per cycle</label>
        <div class="row" style="gap: 6px">
          <input
            id="cycleDuration"
            type="number"
            inputmode="numeric"
            min="1"
            value="60"
            step="1"
          />
          <select id="cycleUnit">
            <option value="seconds" selected>Seconds</option>
            <option value="minutes">Minutes</option>
          </select>
        </div>
      </div>
      <div class="col">
        <label>Session limit (choose one)</label>
        <select id="sessionMode">
          <option value="infinite">Run until Stop</option>
          <option value="cycles">Total cycles (set below)</option>
          <option value="time">Total session time</option>
        </select>
      </div>
    </div>

    <div class="row" style="margin-top: 8px">
      <div class="col">
        <label id="cyclesLabel">Total cycles</label>
        <input
          id="totalCycles"
          type="number"
          inputmode="numeric"
          min="1"
          value="5"
          step="1"
        />
      </div>
      <div class="col">
        <label id="totalTimeLabel">Total session time</label>
        <div class="row" style="gap: 6px">
          <input
            id="totalTime"
            type="number"
            inputmode="numeric"
            min="1"
            value="300"
            step="1"
          />
          <select id="totalTimeUnit">
            <option value="seconds" selected>Seconds</option>
            <option value="minutes">Minutes</option>
            <option value="hours">Hours</option>
          </select>
        </div>
      </div>
    </div>

    <div class="controls">
      <button id="startBtn">Start</button>
      <button id="pauseBtn" disabled>Pause</button>
      <button id="nextBtn" disabled>Next</button>
      <button id="stopBtn" disabled>Stop</button>
      <!-- Tempo-synced count-in toggle: unchecked = Fixed (1s steps); checked = Tempo-synced -->
      <label class="toggle" style="margin-left: 12px">
        <input id="tempoSyncedToggle" type="checkbox" />
        <span id="tempoSyncedLabel">Tempo-synced Count-in</span>
      </label>
    </div>
    <div class="status" aria-live="polite">
      <div class="big" id="displayBpm">BPM: —</div>
      <div class="big" id="displayGroove">Groove: —</div>
      <div style="margin-top: 8px">
        Cycle remaining time: <span id="countdown">—</span> s
      </div>

      <div style="margin-top: 6px">
        Cycles done: <span id="cyclesDone">0</span>
      </div>

      <div style="margin-top: 6px">
        Session remaining time: <span id="sessionCountdown">—</span> s
      </div>

      <div style="margin-top: 8px">
        <span id="finishingBadge" class="finishing-badge">Finishing bar…</span>
      <div id="metronomeVisuals">
  <div id="countdownBadge" class="countdown-badge"></div>
  <div id="beat-indicator-container"></div>
</div>


    <!-- JS -->
    <script type="module" src="./js/main.js"></script>
  </body>
  <footer id="shortcutHints">
    <div class="footer-hotkeys">
      🎵<strong>Keyboard Hotkeys:</strong><br />
  ⎵ Space = ▶️ Start / ⏹️ Stop &nbsp;&nbsp;
  P = ⏸️ Pause / ▶️ Resume &nbsp;•&nbsp;
  N = ⏭️ Next Groove &nbsp;•&nbsp;
    </div>
    <div class="footer-hotkeys advanced">
      ⚙️<strong>Advanced Hotkeys:</strong><br />
       ⬆️ / ⬇️ = Adjust BPM (±5) •
      ⇧(Shift) + ⬆️ / ⬇️ = Fine Tune (±1) •
       ← / → = 🎚️ Switch Min/Max
    </div>
</footer>
</html>
