<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Manifest -->
    <link rel="manifest" href="manifest.webmanifest" />
    <!-- Theme Color for Browser Toolbar -->
    <meta name="theme-color" content="#4e4e4e" />
    <!-- Apple Touch Icon for iOS devices -->
    <link rel="apple-touch-icon" href="./assets/icons/icon-512x512.png" />
    <!-- Apple-specific settings -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <!-- Include noUiSlider CSS -->
    <link rel="stylesheet" href="libs/css/nouislider.min.css" />
    <link rel="icon" href="./favicon.ico" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Random Groove Trainer &amp; Metronome</title>
    <link rel="stylesheet" href="./css/styles.css" />
    <meta
      name="msapplication-square70x70logo"
      content="./assets/mstile/mstile-icon-128.png"
    />
    <meta
      name="msapplication-square150x150logo"
      content="./assets/mstile/mstile-icon-270.png"
    />
    <meta
      name="msapplication-square310x310logo"
      content="./assets/mstile/mstile-icon-558.png"
    />
    <meta
      name="msapplication-wide310x150logo"
      content="./assets/mstile/mstile-icon-558-270.png"
    />
    <link rel="apple-touch-icon" href="./assets/icons/apple-icon-180.png" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-2048-2732.png"
      media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-2732-2048.png"
      media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1668-2388.png"
      media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-2388-1668.png"
      media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1536-2048.png"
      media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-2048-1536.png"
      media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1640-2360.png"
      media="(device-width: 820px) and (device-height: 1180px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-2360-1640.png"
      media="(device-width: 820px) and (device-height: 1180px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1668-2224.png"
      media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-2224-1668.png"
      media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1620-2160.png"
      media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-2160-1620.png"
      media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1488-2266.png"
      media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-2266-1488.png"
      media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1320-2868.png"
      media="(device-width: 440px) and (device-height: 956px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-2868-1320.png"
      media="(device-width: 440px) and (device-height: 956px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1206-2622.png"
      media="(device-width: 402px) and (device-height: 874px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-2622-1206.png"
      media="(device-width: 402px) and (device-height: 874px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1260-2736.png"
      media="(device-width: 420px) and (device-height: 912px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-2736-1260.png"
      media="(device-width: 420px) and (device-height: 912px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1290-2796.png"
      media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-2796-1290.png"
      media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1179-2556.png"
      media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-2556-1179.png"
      media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1170-2532.png"
      media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-2532-1170.png"
      media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1284-2778.png"
      media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-2778-1284.png"
      media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1125-2436.png"
      media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-2436-1125.png"
      media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1242-2688.png"
      media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-2688-1242.png"
      media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-828-1792.png"
      media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1792-828.png"
      media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1242-2208.png"
      media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-2208-1242.png"
      media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-750-1334.png"
      media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1334-750.png"
      media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-640-1136.png"
      media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="./assets/apple-splash/apple-splash-1136-640.png"
      media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    />
  </head>
  <body>
    <h1>Random Groove Trainer &amp; Metronome</h1>
    <p class="small">
      Randomize BPM (multiples of 5) + groove name and practice landing grooves
      instantly. Built-in metronome uses lightweight bundled javascript for
      accuracy.
    </p>
    <div id="tooltipTrigger" title="Help / Hotkeys">‚ùî</div>
    <div id="tooltipDialog">
      <div class="tooltip-content">
        <h2>üéµ Random Groove Trainer &amp; Metronome</h2>
        <p>
          This app helps you practice groove transitions by randomly selecting a
          BPM and groove name. You set a BPM range, enter groove names, and
          choose session settings. The built-in metronome guides you through
          each cycle.
        </p>

        <p><strong>How to use:</strong></p>
        <ul>
          <li>Set your desired BPM range</li>
          <li>Enter groove names (one per line)</li>
          <li>Choose session duration or cycle count</li>
          <li>
            Click <strong>Start</strong> or press <strong>Space</strong> to
            begin
          </li>
        </ul>

        <p><strong>Hotkeys:</strong></p>
        <ul>
          <li>H = Show this help</li>
          <li>‚éµ Space = ‚ñ∂Ô∏è Start / ‚èπÔ∏è Stop</li>
          <li>P = ‚è∏Ô∏è Pause / ‚ñ∂Ô∏è Resume</li>
          <li>N = ‚è≠Ô∏è Next Groove</li>
          <li>‚¨ÜÔ∏è / ‚¨áÔ∏è = Adjust BPM (¬±5)</li>
          <li>‚Üê / ‚Üí = Switch Min/Max</li>
        </ul>
      </div>
    </div>
    <button
      id="checkUpdatesBtn"
      class="update-button"
      title="Check for updates"
    >
      ‚ü≥
    </button>

    <!-- TABS -->
    <div class="mode-tabs" role="tablist" aria-label="Mode selector">
      <button
        id="tab-groove"
        class="tab active"
        role="tab"
        aria-selected="true"
      >
        Groove Randomizer
      </button>
      <button id="tab-metronome" class="tab" role="tab" aria-selected="false">
        Metronome
      </button>
    </div>

    <!-- PANELS -->
    <!-- Groove panel -->
    <div id="panel-groove" class="panel">
      <!-- BEGIN existing Groove UI -->
      <label>BPM range (min / max)</label>
      <div class="row">
        <div class="col">
          <input
            id="bpmMin"
            type="number"
            inputmode="numeric"
            min="5"
            max="300"
            value="30"
            step="5"
          />
        </div>
        <div class="col">
          <input
            id="bpmMax"
            type="number"
            inputmode="numeric"
            min="5"
            max="300"
            value="60"
            step="5"
          />
        </div>
      </div>
      <!-- Groove Metronome BPM Range Slider -->
      <div id="groove-slider-container">
        <div id="groove-slider"></div>
        <!-- This is where the noUiSlider will go -->
        <div id="groove-ticks-container" class="groove-ticks-container"></div>
        <!-- Numbers Below the Slider -->
        <div id="slider-numbers">
          <!-- Clickable numbers will be inserted dynamically here -->
        </div>
      </div>

      <label>Groove names (one per line)</label>
      <textarea
        id="grooves"
        rows="10"
        placeholder="Rock 
Funk
Ÿàÿßÿ≠ÿØÿ© ŸàŸÜÿµ
ŸÖŸÇÿ≥ŸàŸÖ
Ÿàÿ≠ÿØÿ© ŸÉÿ®Ÿäÿ±ÿ©
ŸÖŸÑŸÅŸàŸÅ"
      >
Rock
Funk
Ÿàÿßÿ≠ÿØÿ© ŸàŸÜÿµ
ŸÖŸÇÿ≥ŸàŸÖ
Ÿàÿ≠ÿØÿ© ŸÉÿ®Ÿäÿ±ÿ©
ŸÖŸÑŸÅŸàŸÅ</textarea
      >

      <div class="row beats-and-sound-row">
        <div class="beats-section">
          <!-- Time Signature Controls -->
          <div class="time-signature-controls">
            <label for="groovePresetSelect">Time Signature</label>
            <select id="groovePresetSelect">
              <option value="4/4" selected>4/4</option>
              <option value="3/4">3/4</option>
              <option value="2/4">2/4</option>
              <option value="6/8">6/8</option>
              <option value="7/8">7/8</option>
              <option value="12/8">12/8</option>
              <option value="custom">Custom</option>
            </select>
            <!-- Custom Inputs (hidden by default) -->
            <div id="grooveCustomTimeSignature" class="hidden">
              <input
                type="number"
                id="grooveCustomNumerator"
                value="4"
                min="1"
                max="16"
              />
              <span>/</span>
              <input
                type="number"
                id="grooveCustomDenominator"
                value="4"
                min="2"
                max="16"
              />
            </div>
          </div>
          <!-- Subdivision Controls (conditionally visible) -->
          <div id="grooveSubdivisionContainer">
            <label for="grooveSubdivisionSelect">Display Subdivision</label>
            <select id="grooveSubdivisionSelect">
              <option value="1" selected>None</option>
              <option value="2">8th Notes</option>
              <option value="4">16th Notes</option>
            </select>
          </div>
        </div>

        <div class="sound-section">
          <label for="soundProfileGroove">Sound profile</label>
          <select id="soundProfileGroove"></select>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <label>Time per cycle</label>
          <div class="row" style="gap: 6px">
            <input
              id="cycleDuration"
              type="number"
              inputmode="numeric"
              min="1"
              value="60"
              step="1"
            />
            <select id="cycleUnit">
              <option value="seconds" selected>Seconds</option>
              <option value="minutes">Minutes</option>
            </select>
          </div>
        </div>
        <div class="col">
          <label>Session limit (choose one)</label>
          <select id="sessionMode">
            <option value="infinite">Run until Stop</option>
            <option value="cycles">Total cycles (set below)</option>
            <option value="time">Total session time</option>
          </select>
        </div>
      </div>

      <div class="row" style="margin-top: 8px">
        <div class="col">
          <label id="cyclesLabel">Total cycles</label>
          <input
            id="totalCycles"
            type="number"
            inputmode="numeric"
            min="1"
            value="5"
            step="1"
          />
        </div>
        <div class="col">
          <label id="totalTimeLabel">Total session time</label>
          <div class="row" style="gap: 6px">
            <input
              id="totalTime"
              type="number"
              inputmode="numeric"
              min="1"
              value="300"
              step="1"
            />
            <select id="totalTimeUnit">
              <option value="seconds" selected>Seconds</option>
              <option value="minutes">Minutes</option>
              <option value="hours">Hours</option>
            </select>
          </div>
        </div>
      </div>

      <div class="controls">
        <button id="startBtn">Start</button>
        <button id="pauseBtn" disabled>Pause</button>
        <button id="nextBtn" disabled>Next</button>
        <label class="toggle" style="margin-left: 12px">
          <input id="tempoSyncedToggle" type="checkbox" />
          <span id="tempoSyncedLabel">Tempo-synced Count-in</span>
        </label>
      </div>

      <div class="status" aria-live="polite">
        <div class="big" id="displayBpm">BPM: ‚Äî</div>
        <div class="big" id="displayGroove">Groove: ‚Äî</div>
        <div style="margin-top: 8px">
          Cycle remaining time: <span id="countdown">‚Äî</span>
        </div>

        <div style="margin-top: 6px">
          Cycles done: <span id="cyclesDone">0</span>
        </div>

        <div style="margin-top: 6px">
          Session remaining time: <span id="sessionCountdown">‚Äî</span>
        </div>

        <div style="margin-top: 8px">
          <span id="finishingBadge" class="finishing-badge"
            >Finishing bar‚Ä¶</span
          >
        </div>
        <div id="metronomeVisuals">
          <div id="countdownBadge" class="countdown-badge"></div>
          <div id="beat-indicator-container"></div>
        </div>
      </div>
      <!-- END existing Groove UI -->
    </div>

    <!-- Simple Metronome panel (initially hidden) -->
    <div id="panel-metronome" class="panel hidden">
      <!-- BEGIN Simple Metronome UI -->
      <label>Metronome BPM</label>
      <input
        id="simpleBpm"
        type="number"
        inputmode="numeric"
        min="30"
        max="300"
        value="120"
        step="5"
      />
      <!-- Simple Metronome Slider -->
      <div id="simple-slider-container" class="groove-slider-container">
        <div id="simpleMetronomeSlider"></div>
        <div id="simple-ticks-container" class="groove-ticks-container"></div>
        <div id="simple-slider-numbers"></div>
      </div>

      <div class="row beats-and-sound-row">
        <div class="beats-section">
          <!-- Time Signature Controls -->
          <div class="time-signature-controls">
            <label for="simplePresetSelect">Time Signature</label>
            <select id="simplePresetSelect">
              <option value="4/4" selected>4/4</option>
              <option value="3/4">3/4</option>
              <option value="2/4">2/4</option>
              <option value="6/8">6/8</option>
              <option value="7/8">7/8</option>
              <option value="12/8">12/8</option>
              <option value="custom">Custom</option>
            </select>
            <!-- Custom Inputs (hidden by default) -->
            <div id="simpleCustomTimeSignature" class="hidden">
              <input
                type="number"
                id="simpleCustomNumerator"
                value="4"
                min="1"
                max="16"
              />
              <span>/</span>
              <input
                type="number"
                id="simpleCustomDenominator"
                value="4"
                min="2"
                max="16"
              />
            </div>
          </div>
          <!-- Subdivision Controls (conditionally visible) -->
          <div id="simpleSubdivisionContainer">
            <label for="simpleSubdivisionSelect">Display Subdivision</label>
            <select id="simpleSubdivisionSelect">
              <option value="1" selected>None</option>
              <option value="2">8th Notes</option>
              <option value="4">16th Notes</option>
            </select>
          </div>
        </div>

        <div class="sound-section">
          <label for="soundProfileSimple">Sound profile</label>
          <select id="soundProfileSimple"></select>
        </div>
      </div>

      <div class="controls">
        <button id="simpleStartBtn">Start</button>
        <button id="simplePauseBtn" disabled>Pause</button>
        <button id="tapTempoBtn" title="Tap 4‚Äì6 times to set tempo">üñêÔ∏è</button>
      </div>

      <div class="status">
        <div class="big" id="simpleDisplayBpm">BPM: ‚Äî</div>
        <div id="metronomeVisualsSimple" style="margin-top: 12px">
          <div id="countdownBadgeSimple" class="countdown-badge"></div>
          <div id="beat-indicator-container-simple"></div>
        </div>
      </div>
      <!-- END Simple Metronome UI -->
    </div>

    <button
      id="installBtn"
      class="utility-button"
      style="display: none"
      title="Install this app"
    >
      üì≤ Install App
    </button>
    <footer id="VersionNumber"></footer>
    <!-- JS -->
    <script type="module" src="./js/main.js"></script>
    <!-- Include noUiSlider JS -->
    <script src="libs/js/nouislider.min.js"></script>
    <!-- Include GSAP JS -->
    <script src="libs/js/gsap.min.js"></script>
  </body>
  <div id="uiNotice" class="ui-notice hidden"></div>
</html>
